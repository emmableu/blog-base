---
title: 101 - 425 - Word Squares - Hard
date: 2022-08-15 11:19:28
permalink: /pages/598f40/
categories:
  - Google
  - Incomplete
tags:
  - 
---
tags: [Array, String, Backtracking, Trie]

[LC Link](https://leetcode.cn/problems/word-squares/)

![](https://raw.githubusercontent.com/emmableu/image/master/202208151733682.png)

## Solution (Trie + DFS)

api:
```python
>>> a = 'abc'
>>> list(a)
['a', 'b', 'c']
```


##  Solution 1
(by myself, 正确但是 TLE)

```python
import copy
class TrieNode:
	def __init__(self):
		# 本题不需要 is_end, 因为最后一定会找满4个。
		self.children = {}

class TrieMap:
	def __init__(self):
		self.root = TrieNode()

	def put(self, word):
		p = self.root
		for c in word:
			if not p.children.get(c):
				p.children[c] = TrieNode()
			p = p.children[c]

class Solution:
	def wordSquares(self, words: List[str]) -> List[List[str]]:
		trie_map = TrieMap()
		word_size = len(words[0])
		for word in words:
			trie_map.put(word)
		p_list = [trie_map.root for _ in range(word_size)]
		res = []
		self.dfs([], res, words, p_list, trie_map, word_size)
		return res
			
	def dfs(self, path, res, words, p_list, trie_map, word_size):
		if len(path) == word_size:
			res.append(copy.deepcopy(path))
			return

		for cur in range(len(words)):
			can_add = True
			for i, p in enumerate(p_list):
				c = words[cur][i]
				if i < len(path) and c != path[i][len(path)]:
					can_add = False
					break
				if not p.children.get(c):
					can_add = False
					break
			if can_add:
				path.append(words[cur])
				self.dfs(path, res, words, \
						[p.children[words[cur][i]] for i, p in enumerate(p_list)], \
						trie_map, word_size)
				path.pop()
```