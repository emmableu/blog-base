
![](https://raw.githubusercontent.com/emmableu/image/master/202209151913277.png)




```python
class Solution:
    def solveNQueens(self, n: int) -> List[List[str]]:
        res = []
        vis_row, vis_col, vis_diag1, vis_diag2 = set(), set(), set(), set()
        self.dfs([], res, n, vis_row, vis_col, vis_diag1, vis_diag2)
        return res

    def dfs(self, path, res, n, vis_row, vis_col, vis_diag1, vis_diag2):
        if len(path) == n:
            res.append(path.copy())
        r = len(path)
        for c in range(n):
            if not (
                (r in vis_row) or \
                (c in vis_col) or \
                ((0, c - r) in vis_diag1) or \
                ((0, c + r) in vis_diag2)
            ):
                vis_row.add(r)
                vis_col.add(c)
                vis_diag1.add((0, c - r))
                vis_diag2.add((0, c + r))
                
                new_row = ["." for _ in range(n)]
                new_row[c] = "Q"
                path.append("".join(new_row))

                self.dfs(path, res, n, vis_row, vis_col, vis_diag1, vis_diag2)

                path.pop()

                vis_row.remove(r)
                vis_col.remove(c)
                vis_diag1.remove((0, c - r))
                vis_diag2.remove((0, c + r))
```